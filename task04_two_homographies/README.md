# Task 0-4: Two Homographies
1. Select at least one pair of images from the set above. Note that the pair 1-2 is the easiest one and the pair 1-3 is the hardest one considering the stability of solution.
2. Use interest points detected in the images: books_u1.txt, books_u2.txt, books_u3.txt for the image 1, 2, 3, respectively.
3. Use set of tentative correspondences between a selected pair of images: books_m12.txt, books_m13.txt, books_m23.txt
4. Estimate the two dominant homographies by a method of your choice, with homology constraint.
5. Compute the common line.
6. Show the results - show in both images outliers and inliers of either homography (in different colours) and the common line. Show the correspondences as needle map.

## Two Homographies
Consider a pair of images of a scene with two dominant planes, e.g. a pair of images from a triple below. Each plane generate one homography between the image pair. i.e. there are two homographies Ha and Hb.

When a set of tentative correspondences between the images is known these homographies can be estimated. Additionally, since these two homographies are generated by two scene planes, there is a line in both images, that is a projection of the intersecting line of the planes. The image points u1, u2 laying on that line in both images are related by both homographies, i.e., u2 ∼ Ha u1 ∼ Hb u1, which can be written as inv(Hb) Ha u1 = λ u1. Thus these two homographies must be estimated such that these constraint is enforced (two arbitrary regular 3×3 matrices generally do not ensure the existence of such a common line. Note that self constraint means that there exist a common line that is transformed same way by the two complementary line homographies inv(Ha') and inv(Hb') (self line always exists for any two regular 3×3 matrices) but additionally that self line is transformed by both homographies from the first image to the same line in the second one point-wise. Note that self H maps points from the first image to the same image.

The special transformation composed from the such two homographies (given by two planes observed by a pair of cameras ) H = inv(Ha) Hb is called planar homology, and has only 5 degrees of freedom (3 correspondences needed), compared to 8 DoF of a general homography.

There are many methods how to estimate multiple geometric models (homographies in self case) from given data. Two simplest possibilities are:

- Sequential RANSAC
		- Estimate the first homography using standard RANSAC scheme for a single homography. Typically the most dominant one is found.
		- Remove inliers of the first found homography from the data.
		- Estimate the second homography using the remaining data, such that the common homology constraint is enforced (3 correspondences needed)
- Multi RANSAC with conditional sampling
		- Estimate both homographies simultaneously in RANSAC scheme by sampling 7-tuple of correspondences.
		- In every sample:
				- Draw 4 random correspondences and estimate Ha
				- Remove inliers of Ha from the data set
				- Draw 3 random correspondences and estimate Hb with homology constraint
				- Verify support of both homographies, accept the best one

Common homology estimation from three: when Ha is estimated, the sampled three points u_2 (corresponding to three points u_1) are mapped to the first image by inv(Ha) as u_21. Then these correspondences u_1 and u_21 are used for estimating homology H from the three correspondences. Finally, the second homography is computed as Hb = Ha H.

Note that having two homographies an inlier must be decided to which it belongs to. This can be done based on minimal error or according to on which side of common line the point is laying.
